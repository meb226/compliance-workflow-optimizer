<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Compliance Workflow Analysis Platform</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background: #c2c7cc;
            min-height: 100vh;
            padding: 0.5in;
            color: #1a1a1a;
        }
        
        .header {
            background: #1e3a8a;
            border-radius: 6px;
            padding: 1.5rem 0;
            margin: 0 auto 2rem auto;
            max-width: 1600px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }
        
        .header-content {
            margin: 0 auto;
            text-align: center;
            padding: 0 2rem;
        }
        
        .header h1 {
            color: white;
            font-size: 2.25rem;
            margin-bottom: 0.75rem;
            font-weight: 600;
        }
        
        .header p {
            color: rgba(255, 255, 255, 0.95);
            font-size: 1.1rem;
            line-height: 1.6;
            font-weight: 400;
        }
        
        .header-footer {
            font-size: 0.9rem;
            opacity: 0.85;
            margin-top: 0.5rem;
            color: rgba(255, 255, 255, 0.9);
        }
        
        .main-layout {
            max-width: 1600px;
            margin: 0 auto;
            display: grid;
            grid-template-columns: 400px 1fr;
            gap: 1.5rem;
            align-items: stretch;
        }
        
        .left-column {
            display: flex;
            flex-direction: column;
            gap: 1.5rem;
        }
        
        .card {
            background: white;
            border-radius: 6px;
            padding: 2rem;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
            border: 1px solid #e5e7eb;
        }
        
        .input-section {
            min-height: 650px
            display: flex;
            flex-direction: column;
        }
        
        .input-section form {
            display: flex;
            flex-direction: column;
            flex-grow: 1;
        }
        
        .results-section {
            height: 100%;
            display: flex;
            flex-direction: column;
        }
        
        .results-section h2 {
            color: #1a1a1a;
            margin-bottom: 1.5rem;
            font-size: 1.8rem;
            font-weight: 600;
        }
        
        #results {
            display: flex;
            flex-direction: column;
            flex-grow: 1;
        }
        
        .input-section h2 {
            color: #1a1a1a;
            margin-bottom: 1.5rem;
            font-size: 1.5rem;
            font-weight: 600;
        }
        
        .example-section {
            background: #f9fafb;
            border: 1px solid #d1d5db;
            border-radius: 6px;
            padding: 1rem;
            margin-bottom: 1.5rem;
        }
        
        .example-section label {
            color: #4b5563;
            font-size: 0.9rem;
            font-weight: 600;
            margin-bottom: 0.5rem;
        }
        
        .example-section select {
            background: white;
        }
        
        .form-group {
            margin-bottom: 1.5rem;
        }
        
        label {
            display: block;
            margin-bottom: 0.5rem;
            color: #374151;
            font-weight: 600;
            font-size: 0.95rem;
        }
        
        input[type="text"],
        input[type="number"],
        textarea,
        select {
            width: 100%;
            padding: 0.75rem;
            border: 1px solid #d1d5db;
            border-radius: 6px;
            font-size: 1rem;
            transition: border-color 0.2s, box-shadow 0.2s;
            font-family: inherit;
        }
        
        .time-input-group {
            display: grid;
            grid-template-columns: 2fr 1fr;
            gap: 0.5rem;
        }
        
        input[type="text"]:focus,
        input[type="number"]:focus,
        textarea:focus,
        select:focus {
            outline: none;
            border-color: #2563eb;
            box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.1);
        }
        
        textarea {
            resize: vertical;
            min-height: 216px;
        }
        
        .btn {
            background: #1e3a8a;
            color: white;
            padding: 1rem 2rem;
            border-radius: 6px;
            font-size: 1.1rem;
            cursor: pointer;
            transition: background-color 0.2s, box-shadow 0.2s;
            width: 100%;
            font-weight: 600;
        }
        
        .btn:hover {
            background: #1e293b;
            box-shadow: 0 4px 12px rgba(30, 58, 138, 0.3);
        }
        
        .btn:active {
            background: #1e3a8a;
        }
        
        .btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
        }
        
        /* Export Card Styles */
        .export-card {
            display: none;
        }
        
        .export-card.active {
            display: flex;
            flex-grow: 1;
            flex-direction: column;
        }
        
        .export-card h3 {
            color: #1a1a1a;
            margin-bottom: 1.5rem;
            font-size: 1.5rem;
            font-weight: 600;
        }
        
        .export-buttons {
            display: flex;
            flex-direction: column;
            gap: 0.75rem;
            flex-grow: 1;
            justify-content: center;
        }
        
        .export-btn {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
            padding: 1.25rem;
            border: 1px solid #d1d5db;
            background: white;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.2s;
            font-size: 1.1rem;
            font-weight: 600;
            color: #374151;
        }
        
        .export-btn:hover {
            border-color: #2563eb;
            background: #f8fafc;
            color: #1e40af;
        }
        
        .export-btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
        }
        
        .export-btn svg {
            width: 20px;
            height: 20px;
        }
        
        .results-section {
            display: flex;
            flex-direction: column;
        }
        
        .metrics-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1rem;
            margin-bottom: 2rem;
        }
        
        .metric-card {
            background: #059669;
            color: white;
            border-radius: 6px;
            padding: 1.5rem;
        }
        
        .metric-card h3 {
            font-size: 1.15rem;
            opacity: 0.95;
            margin-bottom: 0.5rem;
            font-weight: 600;
        }
        
        .metric-value {
            font-size: 2.5rem;
            font-weight: 700;
            margin-bottom: 0.25rem;
        }
        
        .metric-description {
            font-size: 1rem;
            opacity: 0.9;
        }
        
        .workflow-display {
            background: #f9fafb;
            border-radius: 6px;
            padding: 1.5rem;
            margin-bottom: 2rem;
            border: 1px solid #e5e7eb;
        }
        
        .workflow-display h3 {
            color: #1a1a1a;
            margin-bottom: 1rem;
            font-size: 1.2rem;
            font-weight: 600;
        }
        
        .workflow-steps-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 0.75rem;
            grid-auto-flow: column;
        }
        
        .workflow-column {
            display: flex;
            flex-direction: column;
            gap: 0.75rem;
        }
        
        .step {
            display: flex;
            align-items: center;
            padding: 0.5rem 0.75rem;
            background: white;
            border-radius: 4px;
            border-left: 3px solid #2563eb;
            font-size: 0.9rem;
        }
        
        .step-number {
            background: #1e40af;
            color: white;
            min-width: 24px;
            height: 24px;
            border-radius: 4px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            margin-right: 0.75rem;
            flex-shrink: 0;
            font-size: 0.85rem;
        }
        
        /* Carousel Styles */
        .carousel-container {
            position: relative;
            margin-top: 2rem;
        }
        
        .carousel-header {
            text-align: center;
            margin-bottom: 1.5rem;
        }
        
        .carousel-header h3 {
            color: #1a1a1a;
            font-size: 1.3rem;
            margin-bottom: 0.5rem;
            font-weight: 600;
        }
        
        .carousel-wrapper {
            position: relative;
            overflow: hidden;
            min-height: 400px;
        }
        
        .carousel-slides {
            display: flex;
            transition: transform 0.5s ease;
        }
        
        .carousel-slide {
            min-width: calc(50% - 0.5rem);
            padding: 1.5rem;
            background: #f9fafb;
            border-radius: 6px;
            margin-right: 1rem;
            border: 1px solid #e5e7eb;
        }
        
        .insight-header {
            display: flex;
            align-items: center;
            margin-bottom: 1rem;
            padding-bottom: 1rem;
            border-bottom: 2px solid #e5e7eb;
        }
        
        .insight-header h4 {
            color: #1a1a1a;
            font-size: 1.2rem;
            font-weight: 600;
        }
        
        .insight-content {
            color: #4b5563;
            line-height: 1.6;
            font-size: 0.95rem;
        }
        
        .insight-content p {
            margin-bottom: 1rem;
        }
        
        .insight-content ul {
            margin-left: 1.5rem;
            margin-bottom: 1rem;
        }
        
        .insight-content li {
            margin-bottom: 0.5rem;
        }
        
        .insight-content strong {
            color: #1a1a1a;
            font-weight: 600;
        }
        
        .carousel-controls {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 1rem;
            margin-top: 1.5rem;
        }
        
        .carousel-btn {
            background: #1e3a8a;
            color: white;
            border: none;
            width: 40px;
            height: 40px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 1.2rem;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: background-color 0.2s;
        }
        
        .carousel-btn:hover {
            background: #1e293b;
        }
        
        .carousel-btn:disabled {
            opacity: 0.3;
            cursor: not-allowed;
        }
        
        .carousel-indicators {
            display: flex;
            gap: 0.5rem;
        }
        
        .indicator-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: #d1d5db;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .indicator-dot.active {
            background: #1e3a8a;
            width: 24px;
            border-radius: 4px;
        }
        
        .placeholder {
            text-align: center;
            padding: 4rem 2rem;
            color: #6b7280;
            min-height: 650px;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }
        
        .placeholder-icon {
            font-size: 6rem;
            margin-bottom: 1.5rem;
            color: #9ca3af;
        }
        
        .placeholder h3 {
            font-size: 2rem;
            margin-bottom: 1rem;
            color: #4b5563;
            font-weight: 600;
        }
        
        .placeholder p {
            font-size: 1.15rem;
            line-height: 1.6;
            color: #6b7280;
        }
        
        /* Toast notification */
        .toast {
            position: fixed;
            bottom: 2rem;
            right: 2rem;
            background: #10b981;
            color: white;
            padding: 1rem 1.5rem;
            border-radius: 6px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            display: none;
            align-items: center;
            gap: 0.5rem;
            z-index: 1000;
        }
        
        .toast.show {
            display: flex;
            animation: slideIn 0.3s ease;
        }
        
        @keyframes slideIn {
            from {
                transform: translateX(400px);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }
        
        @media (max-width: 1200px) {
            .main-layout {
                grid-template-columns: 350px 1fr;
            }
        }
        
        @media (max-width: 1024px) {
            .main-layout {
                grid-template-columns: 1fr;
            }
            
            .workflow-steps-grid {
                grid-template-columns: 1fr;
                grid-auto-flow: row;
            }
        }
        
        @media (max-width: 768px) {
            body {
                padding: 0.5in 0.25in;
            }
            
            .header h1 {
                font-size: 2rem;
            }
            
            .metrics-grid {
                grid-template-columns: 1fr;
            }
            
            .toast {
                bottom: 1rem;
                right: 1rem;
                left: 1rem;
            }
        }
    </style>
</head>
<body>
    <div class="header">
        <div class="header-content">
            <h1>Compliance Workflow Analysis Platform</h1>
            <p>AI-driven insights to identify high-impact automation opportunities and strengthen compliance processes across your organization.</p>
            <p class="header-footer">Created by Mike Burns | Powered by Claude AI | github.com/[username]</p>
        </div>
    </div>
    
    <div class="main-layout">
        <!-- Left Column: Input Form & Export -->
        <div class="left-column">
            <div class="card input-section">
                <h2>Describe Your Workflow</h2>
                
                <div class="example-section">
                    <label for="exampleSelect">Try an Example Workflow</label>
                    <select id="exampleSelect">
                        <option value="">Select an example...</option>
                        <option value="sec-filing">SEC Monthly Filing Process</option>
                        <option value="kyc-review">KYC Customer Review</option>
                        <option value="vendor-diligence">Vendor Due Diligence</option>
                        <option value="policy-update">Annual Policy Review</option>
                        <option value="transaction-monitoring">Transaction Monitoring Alert Review</option>
                    </select>
                </div>
                
                <form id="workflowForm">
                    <div class="form-group">
                        <label for="workflowName">Workflow Name</label>
                        <input type="text" id="workflowName" placeholder="e.g., Monthly Regulatory Filing" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="workflowSteps">Workflow Steps (one per line)</label>
                        <textarea id="workflowSteps" placeholder="Example:&#10;Gather data from 5 different systems&#10;Manually validate data accuracy&#10;Format report in Excel&#10;Review with compliance team&#10;Submit to regulator" required></textarea>
                    </div>
                    
                    <div class="form-group">
                        <label for="timeSpent">Time Required</label>
                        <div class="time-input-group">
                            <input type="number" id="timeSpent" placeholder="Time" min="0.5" step="0.5" required>
                            <select id="timeUnit" required>
                                <option value="minutes">minutes</option>
                                <option value="hours" selected>hours</option>
                            </select>
                        </div>
                        <select id="timeFrequency" required style="margin-top: 0.5rem;">
                            <option value="day">per day</option>
                            <option value="week">per week</option>
                            <option value="month" selected>per month</option>
                            <option value="quarter">per quarter</option>
                        </select>
                    </div>
                    
                    <button type="submit" class="btn">Analyze Workflow</button>
                </form>
            </div>
            
            <!-- Export Card (shown after analysis) -->
            <div class="card export-card" id="exportCard">
                <h3>Export Results</h3>
                <div class="export-buttons">
                    <button class="export-btn" id="copyBtn">
                        <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"/>
                        </svg>
                        Copy to Clipboard
                    </button>
                    <button class="export-btn" id="downloadBtn">
                        <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/>
                        </svg>
                        Download PDF
                    </button>
                    <button class="export-btn" id="emailBtn">
                        <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"/>
                        </svg>
                        Email Report
                    </button>
                </div>
            </div>
        </div>
        
        <!-- Right Column: Results -->
        <div class="card results-section">
            <div id="placeholder" class="placeholder">
                <div class="placeholder-icon">üìä</div>
                <h3>Ready to Optimize</h3>
                <p>Fill out the workflow details on the left to see AI-powered insights and automation recommendations.</p>
                <p style="margin-top: 1rem; font-size: 0.9rem;">Try selecting an example workflow to get started quickly</p>
            </div>
            
            <div id="results" style="display: none; flex-direction: column; flex-grow: 1;">
                <h2>AI-Powered Workflow Optimization</h2>
                
                <div class="metrics-grid">
                    <div class="metric-card">
                        <h3>Estimated Time Savings</h3>
                        <div class="metric-value" id="timeSavings">--</div>
                        <div class="metric-description" id="timeSavingsDesc">hours saved per cycle</div>
                    </div>
                    <div class="metric-card">
                        <h3>Risk Reduction</h3>
                        <div class="metric-value" id="riskReduction">--</div>
                        <div class="metric-description">fewer manual errors</div>
                    </div>
                </div>
                
                <div class="workflow-display">
                    <h3>Your Workflow Steps</h3>
                    <div class="workflow-steps-grid" id="workflowStepsDisplay"></div>
                </div>
                
                <div class="carousel-container">
                    <div class="carousel-header">
                        <h3>AI-Generated Insights</h3>
                        <p>Personalized recommendations for your workflow</p>
                    </div>
                    <div class="carousel-wrapper">
                        <div class="carousel-slides" id="carouselSlides"></div>
                    </div>
                    <div class="carousel-controls">
                        <button class="carousel-btn" id="prevBtn">‚Üê</button>
                        <div class="carousel-indicators" id="indicators"></div>
                        <button class="carousel-btn" id="nextBtn">‚Üí</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Toast Notification -->
    <div class="toast" id="toast">
        <span>‚úì</span>
        <span id="toastMessage">Copied to clipboard!</span>
    </div>
    
    <script>
        let currentSlide = 0;
        let insights = [];
        let currentAnalysis = null;
        
        const examples = {
            'sec-filing': {
                name: 'SEC Monthly Filing Process',
                steps: `Collect trading data from 5 systems
Manually reconcile discrepancies
Calculate key metrics in Excel
Validate against prior month
Format report per SEC requirements
Internal review and approval
Upload to SEC EDGAR system`,
                time: 16,
                frequency: 'month'
            },
            'kyc-review': {
                name: 'KYC Customer Review',
                steps: `Pull customer data from CRM
Search sanctions and PEP lists
Review adverse media
Verify documentation completeness
Risk score calculation
Compliance officer approval
Update customer file`,
                time: 2.5,
                frequency: 'day'
            },
            'vendor-diligence': {
                name: 'Vendor Due Diligence',
                steps: `Request vendor documentation
Review financial statements
Check regulatory history
Assess cyber security practices
Contract review and negotiation
Risk assessment scoring
Final approval and onboarding`,
                time: 20,
                frequency: 'quarter'
            },
            'policy-update': {
                name: 'Annual Policy Review',
                steps: `Review regulatory changes
Update policy language
Stakeholder review and feedback
Legal department approval
Board presentation preparation
Policy distribution and training
Acknowledgment tracking`,
                time: 40,
                frequency: 'quarter'
            },
            'transaction-monitoring': {
                name: 'Transaction Monitoring Alert Review',
                steps: `Review flagged transactions
Gather customer background info
Analyze transaction patterns
Determine if suspicious
Document investigation findings
Escalate or close alert
Update monitoring rules`,
                time: 6,
                frequency: 'week'
            }
        };
        
        const form = document.getElementById('workflowForm');
        const exampleSelect = document.getElementById('exampleSelect');
        const placeholder = document.getElementById('placeholder');
        const results = document.getElementById('results');
        const exportCard = document.getElementById('exportCard');
        const workflowStepsDisplay = document.getElementById('workflowStepsDisplay');
        const timeSavings = document.getElementById('timeSavings');
        const timeSavingsDesc = document.getElementById('timeSavingsDesc');
        const riskReduction = document.getElementById('riskReduction');
        const carouselSlides = document.getElementById('carouselSlides');
        const indicators = document.getElementById('indicators');
        const prevBtn = document.getElementById('prevBtn');
        const nextBtn = document.getElementById('nextBtn');
        const copyBtn = document.getElementById('copyBtn');
        const downloadBtn = document.getElementById('downloadBtn');
        const emailBtn = document.getElementById('emailBtn');
        const toast = document.getElementById('toast');
        const toastMessage = document.getElementById('toastMessage');
        
        // Example selection handler
        exampleSelect.addEventListener('change', (e) => {
            const selectedExample = examples[e.target.value];
            if (selectedExample) {
                document.getElementById('workflowName').value = selectedExample.name;
                document.getElementById('workflowSteps').value = selectedExample.steps;
                document.getElementById('timeSpent').value = selectedExample.time;
                document.getElementById('timeFrequency').value = selectedExample.frequency;
            }
        });
        
        // Toast notification function
        function showToast(message) {
            toastMessage.textContent = message;
            toast.classList.add('show');
            setTimeout(() => {
                toast.classList.remove('show');
            }, 3000);
        }
        
        // Copy to clipboard
        copyBtn.addEventListener('click', () => {
            const text = generateReportText();
            navigator.clipboard.writeText(text).then(() => {
                showToast('Report copied to clipboard!');
            }).catch(() => {
                showToast('Failed to copy. Please try again.');
            });
        });
        
        // Helper function to extract clean text from HTML
        function htmlToText(html) {
            const temp = document.createElement('div');
            temp.innerHTML = html;
            return temp.textContent || temp.innerText || '';
        }
        
        // Download PDF
        downloadBtn.addEventListener('click', async () => {
            downloadBtn.disabled = true;
            const originalText = downloadBtn.innerHTML;
            downloadBtn.innerHTML = '<span style="font-size: 0.9rem;">Generating PDF...</span>';
            
            try {
                const { jsPDF } = window.jspdf;
                const pdf = new jsPDF('p', 'mm', 'a4');
                
                const pageWidth = pdf.internal.pageSize.getWidth();
                const pageHeight = pdf.internal.pageSize.getHeight();
                const margin = 20;
                let y = margin;
                
                // Header with solid background
                pdf.setFillColor(30, 64, 175);
                pdf.rect(0, 0, pageWidth, 45, 'F');
                pdf.setTextColor(255, 255, 255);
                pdf.setFontSize(26);
                pdf.setFont(undefined, 'bold');
                pdf.text('Workflow Optimization Report', pageWidth / 2, 25, { align: 'center' });
                pdf.setFontSize(11);
                pdf.setFont(undefined, 'normal');
                pdf.text(`Generated: ${new Date().toLocaleDateString()}`, pageWidth / 2, 35, { align: 'center' });
                
                pdf.setTextColor(0, 0, 0);
                y = 60;
                
                // Workflow Name
                pdf.setFontSize(18);
                pdf.setFont(undefined, 'bold');
                pdf.text(currentAnalysis.name, margin, y);
                y += 10;
                
                pdf.setFontSize(11);
                pdf.setFont(undefined, 'normal');
                pdf.text(`Time Commitment: ${currentAnalysis.time} hours ${currentAnalysis.frequency}`, margin, y);
                y += 15;
                
                // Key Metrics Section
                pdf.setFontSize(16);
                pdf.setFont(undefined, 'bold');
                pdf.text('Key Metrics', margin, y);
                y += 10;
                
                // Time Savings Box
                pdf.setFillColor(30, 64, 175);
                pdf.roundedRect(margin, y, 80, 28, 3, 3, 'F');
                pdf.setTextColor(255, 255, 255);
                pdf.setFontSize(10);
                pdf.setFont(undefined, 'normal');
                pdf.text('Time Savings', margin + 5, y + 7);
                pdf.setFontSize(20);
                pdf.setFont(undefined, 'bold');
                pdf.text(timeSavings.textContent, margin + 5, y + 18);
                pdf.setFontSize(8);
                pdf.setFont(undefined, 'normal');
                const timeSavingsText = pdf.splitTextToSize(timeSavingsDesc.textContent, 70);
                pdf.text(timeSavingsText, margin + 5, y + 24);
                
                // Risk Reduction Box
                pdf.setFillColor(30, 58, 138);
                pdf.roundedRect(margin + 90, y, 80, 28, 3, 3, 'F');
                pdf.setFontSize(10);
                pdf.text('Risk Reduction', margin + 95, y + 7);
                pdf.setFontSize(20);
                pdf.setFont(undefined, 'bold');
                pdf.text(riskReduction.textContent, margin + 95, y + 18);
                pdf.setFontSize(8);
                pdf.setFont(undefined, 'normal');
                pdf.text('fewer manual errors', margin + 95, y + 24);
                
                y += 40;
                pdf.setTextColor(0, 0, 0);
                
                // Workflow Steps
                pdf.setFontSize(16);
                pdf.setFont(undefined, 'bold');
                pdf.text('Workflow Steps', margin, y);
                y += 10;
                
                pdf.setFontSize(10);
                pdf.setFont(undefined, 'normal');
                currentAnalysis.steps.forEach((step, i) => {
                    if (y > pageHeight - 30) {
                        pdf.addPage();
                        y = margin;
                    }
                    const stepText = `${i + 1}. ${step}`;
                    const lines = pdf.splitTextToSize(stepText, pageWidth - 2 * margin - 10);
                    pdf.text(lines, margin + 5, y);
                    y += lines.length * 6 + 2;
                });
                
                y += 8;
                
                // AI Insights
                pdf.setFontSize(16);
                pdf.setFont(undefined, 'bold');
                pdf.text('AI-Generated Insights', margin, y);
                y += 10;
                
                insights.forEach((insight, i) => {
                    if (y > pageHeight - 50) {
                        pdf.addPage();
                        y = margin;
                    }
                    
                    // Insight Title
                    pdf.setFontSize(13);
                    pdf.setFont(undefined, 'bold');
                    pdf.text(insight.title, margin, y);
                    y += 8;
                    
                    // Parse the HTML content
                    const tempDiv = document.createElement('div');
                    tempDiv.innerHTML = insight.content;
                    
                    // Get paragraphs
                    const paragraphs = tempDiv.querySelectorAll('p');
                    paragraphs.forEach(p => {
                        const text = p.textContent.trim();
                        if (text) {
                            pdf.setFontSize(10);
                            pdf.setFont(undefined, 'normal');
                            const lines = pdf.splitTextToSize(text, pageWidth - 2 * margin - 5);
                            lines.forEach(line => {
                                if (y > pageHeight - 20) {
                                    pdf.addPage();
                                    y = margin;
                                }
                                pdf.text(line, margin + 5, y);
                                y += 5;
                            });
                            y += 3;
                        }
                    });
                    
                    // Get list items
                    const listItems = tempDiv.querySelectorAll('li');
                    listItems.forEach(li => {
                        const text = li.textContent.trim();
                        if (text) {
                            if (y > pageHeight - 25) {
                                pdf.addPage();
                                y = margin;
                            }
                            pdf.setFontSize(9);
                            pdf.setFont(undefined, 'normal');
                            // Add bullet
                            pdf.text('‚Ä¢', margin + 8, y);
                            const lines = pdf.splitTextToSize(text, pageWidth - 2 * margin - 15);
                            lines.forEach((line, lineIdx) => {
                                if (lineIdx > 0 && y > pageHeight - 20) {
                                    pdf.addPage();
                                    y = margin;
                                }
                                pdf.text(line, margin + 12, y);
                                y += 5;
                            });
                            y += 1;
                        }
                    });
                    
                    y += 8;
                });
                
                // Footer on all pages
                const pageCount = pdf.internal.getNumberOfPages();
                for (let i = 1; i <= pageCount; i++) {
                    pdf.setPage(i);
                    pdf.setFontSize(8);
                    pdf.setTextColor(128, 128, 128);
                    pdf.text(
                    `Compliance Workflow Analysis Platform | Page ${i} of ${pageCount}`,
                    pageWidth / 2,
                    pageHeight - 10,
                    { align: 'center' }
                    );
                }
                
                pdf.save(`workflow-analysis-${Date.now()}.pdf`);
                showToast('PDF downloaded successfully!');
            } catch (error) {
                console.error('PDF generation error:', error);
                showToast('Error generating PDF. Please try again.');
            } finally {
                downloadBtn.disabled = false;
                downloadBtn.innerHTML = originalText;
            }
        });
        
        // Email report
        emailBtn.addEventListener('click', () => {
            const text = generateReportText();
            const subject = encodeURIComponent(`Workflow Analysis: ${currentAnalysis.name}`);
            const body = encodeURIComponent(text);
            window.location.href = `mailto:?subject=${subject}&body=${body}`;
        });
        
        // Generate report text
        function generateReportText() {
            if (!currentAnalysis) return '';
            
            let text = `COMPLIANCE WORKFLOW OPTIMIZATION REPORT\n`;
            text += `Generated: ${new Date().toLocaleDateString()}\n`;
            text += `${'='.repeat(60)}\n\n`;
            
            text += `WORKFLOW: ${currentAnalysis.name}\n`;
            text += `TIME COMMITMENT: ${currentAnalysis.time} hours ${currentAnalysis.frequency}\n\n`;
            
            text += `WORKFLOW STEPS:\n`;
            currentAnalysis.steps.forEach((step, i) => {
                text += `${i + 1}. ${step}\n`;
            });
            text += `\n`;
            
            text += `KEY METRICS:\n`;
            text += `‚Ä¢ Time Savings: ${timeSavings.textContent} ${timeSavingsDesc.textContent}\n`;
            text += `‚Ä¢ Risk Reduction: ${riskReduction.textContent} fewer manual errors\n\n`;
            
            text += `AI-GENERATED INSIGHTS:\n\n`;
            insights.forEach((insight, i) => {
                text += `${i + 1}. ${insight.title}\n`;
                const content = htmlToText(insight.content);
                text += `${content}\n\n`;
            });
            
            text += `${'='.repeat(60)}\n`;
            text += `This report was generated by the Compliance Workflow Analysis Platform\n`;
            
            return text;
        }
        
        form.addEventListener('submit', async (e) => {
            e.preventDefault();
            
            const workflowName = document.getElementById('workflowName').value;
            const workflowSteps = document.getElementById('workflowSteps').value;
            const timeSpent = parseFloat(document.getElementById('timeSpent').value);
            const timeUnit = document.getElementById('timeUnit').value;
            const timeFrequency = document.getElementById('timeFrequency').value;
            
            // Convert to hours if minutes
            const timeInHours = timeUnit === 'minutes' ? timeSpent / 60 : timeSpent;
            
            // Store current analysis
            const steps = workflowSteps.split('\n').filter(step => step.trim());
            currentAnalysis = {
                name: workflowName,
                steps: steps,
                time: timeInHours,
                timeDisplay: `${timeSpent} ${timeUnit}`,
                frequency: timeFrequency
            };
            
            // Display workflow steps in two columns
            const midpoint = Math.ceil(steps.length / 2);
            const col1Steps = steps.slice(0, midpoint);
            const col2Steps = steps.slice(midpoint);
            
            const col1HTML = col1Steps.map((step, index) => `
                <div class="step">
                    <div class="step-number">${index + 1}</div>
                    <div>${step.replace(/^\d+\.\s*/, '')}</div>
                </div>
            `).join('');
            
            const col2HTML = col2Steps.map((step, index) => `
                <div class="step">
                    <div class="step-number">${midpoint + index + 1}</div>
                    <div>${step.replace(/^\d+\.\s*/, '')}</div>
                </div>
            `).join('');
            
            workflowStepsDisplay.innerHTML = `
                <div class="workflow-column">${col1HTML}</div>
                <div class="workflow-column">${col2HTML}</div>
            `;
            
            // Calculate metrics
            const savingsPercent = 40 + Math.random() * 20;
            const savedHours = (timeInHours * savingsPercent / 100).toFixed(1);
            const riskPercent = (35 + Math.random() * 25).toFixed(0);
            
            timeSavings.textContent = `${savedHours} hours`;
            timeSavingsDesc.textContent = `saved ${timeFrequency === 'day' ? 'per day' : timeFrequency === 'week' ? 'per week' : timeFrequency === 'month' ? 'per month' : 'per quarter'}`;
            riskReduction.textContent = `${riskPercent}%`;
            
            // Generate insights
            await generateInsights(workflowName, steps, timeInHours, timeFrequency);
            
            // Show results and export card
            placeholder.style.display = 'none';
            results.style.display = 'block';
            exportCard.classList.add('active');
        });
        
        async function generateInsights(name, steps, time, frequency) {
            const frequencyMap = {
                'day': { multiplier: 250, label: 'annually' },
                'week': { multiplier: 52, label: 'annually' },
                'month': { multiplier: 12, label: 'annually' },
                'quarter': { multiplier: 4, label: 'annually' }
            };
            
            const freq = frequencyMap[frequency];
            const annualHours = (time * 0.45 * freq.multiplier).toFixed(0);
            const annualCost = (annualHours * 75).toLocaleString();
            
            insights = [
            {
                title: 'Automation Opportunities',
                content: `<p>Based on your ${name} workflow, we've identified several high-impact automation opportunities:</p>
                    <ul>
                        <li><strong>Data Collection:</strong> API integrations can automatically pull data from your ${steps.length} different sources, eliminating manual gathering and reducing errors by up to 85%.</li>
                        <li><strong>Validation Rules:</strong> Implement automated validation checks that run in real-time, catching issues before they become problems.</li>
                        <li><strong>Report Generation:</strong> Template-based automation can format your reports instantly, saving 2-3 hours per cycle.</li>
                        <li><strong>Workflow Orchestration:</strong> Chain tasks together so they flow automatically from data collection through final submission.</li>
                    </ul>`
            },
            {
                title: 'Quick Wins',
                content: `<p>Start with these immediate improvements that require minimal setup:</p>
                    <ul>
                        <li><strong>Email Alerts:</strong> Set up automatic notifications when key data sources are updated, eliminating daily check-ins.</li>
                        <li><strong>Data Templates:</strong> Standardize your data collection formats to reduce formatting time by 60%.</li>
                        <li><strong>Approval Workflows:</strong> Implement digital approval chains to cut review cycles from days to hours.</li>
                        <li><strong>Version Control:</strong> Track changes automatically to maintain audit trails without manual documentation.</li>
                        <li><strong>Calendar Integration:</strong> Automatic deadline reminders ensure nothing falls through the cracks.</li>
                    </ul>`
            },
            {
                title: 'Risk Mitigation',
                content: `<p>Strengthen your compliance posture with these risk-reduction strategies:</p>
                    <ul>
                        <li><strong>Automated Controls:</strong> Build systematic checks that verify data accuracy and completeness before submission.</li>
                        <li><strong>Audit Trail:</strong> Maintain automatic logs of every action, creating a comprehensive compliance record.</li>
                        <li><strong>Exception Management:</strong> Flag unusual patterns or outliers for human review, combining AI detection with expert judgment.</li>
                        <li><strong>Dual Control:</strong> Implement maker-checker processes digitally to ensure proper oversight without slowing workflows.</li>
                        <li><strong>Regulatory Updates:</strong> Monitor regulatory changes automatically and alert teams to required process adjustments.</li>
                    </ul>`
            },
            {
                title: 'ROI Projection',
                content: `<p>Based on your ${time}-hour workflow ${frequency === 'day' ? 'daily' : frequency === 'week' ? 'weekly' : frequency === 'month' ? 'monthly' : 'quarterly'}, here's what automation could mean:</p>
                    <ul>
                        <li><strong>Annual Time Savings:</strong> Approximately ${annualHours} hours ${freq.label}, freeing your team for higher-value analysis.</li>
                        <li><strong>Cost Reduction:</strong> Save $${annualCost} ${freq.label} (assuming $75/hour average cost).</li>
                        <li><strong>Error Reduction:</strong> Decrease compliance incidents by an estimated 35-60%, reducing regulatory risk and potential penalties.</li>
                        <li><strong>Scalability:</strong> Handle 3-4x more volume without proportional staff increases.</li>
                        <li><strong>Staff Satisfaction:</strong> Reduce burnout by eliminating repetitive manual tasks and empowering teams to focus on strategic work.</li>
                    </ul>`
            }
            ];
            
            renderCarousel();
        }
        
        function renderCarousel() {
            carouselSlides.innerHTML = insights.map(insight => `
                <div class="carousel-slide">
                    <div class="insight-header">
                        <h4>${insight.title}</h4>
                    </div>
                    <div class="insight-content">${insight.content}</div>
                </div>
            `).join('');
            
            indicators.innerHTML = insights.map((_, index) => `
                <div class="indicator-dot ${index === 0 ? 'active' : ''}" data-index="${index}"></div>
            `).join('');
            
            document.querySelectorAll('.indicator-dot').forEach(dot => {
                dot.addEventListener('click', () => {
                    goToSlide(parseInt(dot.dataset.index));
                });
            });
            
            currentSlide = 0;
            updateCarousel();
        }
        
        function updateCarousel() {
            const slideWidth = 50;
            carouselSlides.style.transform = `translateX(-${currentSlide * slideWidth}%)`;
            
            document.querySelectorAll('.indicator-dot').forEach((dot, index) => {
                dot.classList.toggle('active', index === currentSlide || index === currentSlide + 1);
            });
            
            prevBtn.disabled = currentSlide === 0;
            nextBtn.disabled = currentSlide >= insights.length - 2;
        }
        
        function goToSlide(index) {
            currentSlide = index;
            updateCarousel();
        }
        
        prevBtn.addEventListener('click', () => {
            if (currentSlide > 0) {
                currentSlide--;
                updateCarousel();
            }
        });
        
        nextBtn.addEventListener('click', () => {
            if (currentSlide < insights.length - 2) {
                currentSlide++;
                updateCarousel();
            }
        });
    </script>
</body>
</html>